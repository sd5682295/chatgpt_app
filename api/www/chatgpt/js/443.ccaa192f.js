"use strict";(globalThis["webpackChunkgtphtml"]=globalThis["webpackChunkgtphtml"]||[]).push([[443],{3297:(e,t,a)=>{a.d(t,{c:()=>r});var s=a(7524),l=a(1809),i=a(1650),o=a(6850),n=a(8339);const r=(0,l.Q_)("useMainLayoutData",{state:()=>({apiKey:"",validApiKey:!1,router:(0,n.tv)()}),getters:{},actions:{checkVipExpire(){const e=(0,i.m)().vipExpirationDate.getTime()-(new Date).getTime();if(e<=0)return"VIP已过期";{const t=Math.ceil(e/864e5);return`VIP还有${t}天过期`}},validateApiKey(e){const t=/^sk-[a-zA-Z0-9]{40,50}$/;return this.validApiKey=t.test(e),this.validApiKey||"输入格式不正确，请输入以 sk- 开头的 40-50 位字母或数字组成的字符串"},saveApiKey(){!1===this.validApiKey&&alert("请输入正确的apiKey");const e=localStorage.getItem("session");s.Z.post(`${(0,o.Z)().baseUrl}/saveApiKey/`,JSON.stringify({apiKey:this.apiKey,session:e}),{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((e=>{console.log("Save API Key response:",e.msg)})).catch((e=>{console.error("Save API Key error:",e)}))},handleUserClick(){console.log("用户功能还没完成")},handleUpgradeVipClick(){console.log("升级vip功能还没完成")},handleLogoutClick(){localStorage.removeItem("session"),(0,i.m)().userName="",(0,i.m)().password="",this.router.push("register-page")},handleMessageClick(){console.log("留言功能还没完成")},handleAboutUsClick(){alert("我们的信息")}}})},1650:(e,t,a)=>{a.d(t,{m:()=>c});var s=a(1809),l=a(7813),i=a(7524),o=a(8339),n=a(6850),r=a(3297);const c=(0,s.Q_)("register",{state:()=>({password:"",userName:"",vipExpirationDate:new Date,router:(0,o.tv)(),validUserName:!1,validPassWord:!1,isLoading:!1}),actions:{validateUserName(e){const t=/^[a-zA-Z0-9_]{4,20}$/;return this.validUserName=t.test(e),this.validUserName||"请使用 4 到 20 个字符的字母、数字或下划线作为用户名。"},validatePassword(e){const t=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[-_!@])[A-Za-z\d-_\!@]{8,20}$/;return this.validPassWord=t.test(e),this.validPassWord||"密码必须包含大小写字母、数字和特殊字符，长度为8-20个字符"},handleResponse(e){let t=e.data;if("string"===typeof t){t=t.replace(/NaN/g,'""').replace(/\n/g,"").trim();try{t=JSON.parse(t)}catch(a){}}return t},login(){const e=JSON.stringify({username:this.userName,password:l.V8.hashStr(this.password)});i.Z.post(`${(0,n.Z)().baseUrl}/login/`,e,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((e=>{const t=this.handleResponse(e);if(this.isLoading=!1,0!==t.resCode)alert("用户名或者密码错误"),this.password="";else{function a(e){const t=Date.parse(e),a=new Date(t);return a}localStorage.setItem("session",t.session),this.vipExpirationDate=a(t.vipExpirationDate),(0,r.c)().apiKey=t.apiKey,this.router.push("chat-page"),console.log("注册或者创建成功")}})).catch((e=>{console.error(e)}))},usernameRule(){return[e=>!!e||"Username is required.",e=>e.length<=20||"Username must be less than or equal to 20 characters."]},passwordRule(){return[e=>!!e||"Password is required.",e=>e.length>=6||"Password must be at least 6 characters."]},getUseNameAsSession(){console.log("-1");const e=localStorage.getItem("session");if(console.log(e),e){const t=JSON.stringify({session:e}),a={"Content-Type":"application/json","Access-Control-Allow-Origin":"*"};i.Z.post(`${(0,n.Z)().baseUrl}/session/`,t,{headers:a}).then((e=>{console.log(e);const t=this.handleResponse(e);function a(e){const t=Date.parse(e),a=new Date(t);return a}0!==t.resCode?(console.log(["--aa1--",t]),this.userName="",this.password="",this.vipExpirationDate=new Date,localStorage.removeItem("session"),this.router.push("/register-page")):(console.log(["验证通过",t]),this.vipExpirationDate=a(t.vipExpirationDate),(0,r.c)().apiKey=t.apiKey,this.router.push("/chat-page"))})).catch((e=>{this.router.push("/register-page")}))}else this.userName="",this.password="",this.vipExpirationDate=new Date,localStorage.removeItem("session"),this.router.push("/register-page")}}})},6850:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(1809);const l=(0,s.Q_)("config",{state:()=>({baseUrl:"http://120.48.84.244:5000/"}),actions:{}})},7443:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(9835),l=a(6970),i=a(1957);const o={class:"q-mr-auto q-ml-4",style:{"max-width":"600px",width:"100%","margin-top":"20px"}};function n(e,t,a,n,r,c){const u=(0,s.up)("q-btn"),p=(0,s.up)("q-block"),d=(0,s.up)("q-input"),h=(0,s.up)("q-item-section"),g=(0,s.up)("q-item"),m=(0,s.up)("q-icon"),w=(0,s.up)("q-list"),k=(0,s.up)("q-menu"),f=(0,s.up)("q-toolbar"),y=(0,s.up)("q-header"),v=(0,s.up)("router-view"),C=(0,s.up)("q-page-container"),_=(0,s.up)("q-layout"),b=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(_,{view:"hHh Lpr lFf"},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{elevated:"",class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{class:"row"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{color:"VIP已过期"===e.checkVipExpire()?"grey":"primary",size:"md",class:"font-bold"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.checkVipExpire()),1)])),_:1},8,["color"]),(0,s.Wm)(p,{style:{width:"20px"}}),(0,s._)("div",o,[(0,s.Wm)(d,{modelValue:e.apiKey,"onUpdate:modelValue":t[0]||(t[0]=t=>e.apiKey=t),label:"API Key",dense:"",outlined:"",class:"q-mt-2",rules:[e.validateApiKey],"lazy-rules":""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{flat:"",label:"set",onClick:e.saveApiKey},null,8,["onClick"])])),_:1},8,["modelValue","rules"])]),(0,s.Wm)(u,{flat:"",round:"",icon:"menu"},{default:(0,s.w5)((()=>[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.handleUserClick},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("用户")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.handleUpgradeVipClick},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("升级vip")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.handleLogoutClick},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("退出")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.handleMessageClick},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("留言")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.Wm)(g,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" 管理员 ")])),_:1}),(0,s.Wm)(h,{side:""},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{name:"keyboard_arrow_right"})])),_:1}),(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.goToChatPage},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Chat")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.goToRegisterPage},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Register")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.goToBuyPage},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Buy")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.goToUserAdmin},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("User Admin")])),_:1})])),_:1},8,["onClick"])),[[b]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.checkVipExpire},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("checkVip")])),_:1})])),_:1},8,["onClick"])),[[b]])])),_:1})])),_:1})])),_:1}),(0,s.wy)(((0,s.wg)(),(0,s.j4)(g,{clickable:"",onClick:e.handleAboutUsClick},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Uk)("关于我们")])),_:1})])),_:1},8,["onClick"])),[[b]])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.wy)((0,s.Wm)(C,null,{default:(0,s.w5)((()=>[(0,s.Wm)(v)])),_:1},512),[[i.F8,!0]])])),_:1})}var r=a(1809);function c(e,t,a,l,i,o){const n=(0,s.up)("q-item-section"),r=(0,s.up)("q-item"),c=(0,s.up)("q-list"),u=(0,s.up)("q-menu"),p=(0,s.up)("q-btn"),d=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(p,{class:"col-1",flat:"",style:{width:"20px"},dense:"",icon:"menu"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(r,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{onClick:t[0]||(t[0]=t=>e.leftDrawerOpen=!e.leftDrawerOpen)},{default:(0,s.w5)((()=>[(0,s.Uk)("设置")])),_:1})])),_:1})),[[d]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(r,{clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{onClick:t[1]||(t[1]=t=>e.router.push("register-page"))},{default:(0,s.w5)((()=>[(0,s.Uk)("login")])),_:1})])),_:1})),[[d]])])),_:1})])),_:1})])),_:1})}const u=(0,r.Q_)("headerBtnMenuData",{state:()=>({leftDrawerOpen:!1,userName:"testa",searchType:"anki"})});var p=a(1650);const d=(0,s.aZ)({name:"headerBtnMenu",computed:Object.assign(Object.assign({},(0,r.Ah)(u,["leftDrawerOpen"])),(0,r.Ah)(p.m,["router"]))});var h=a(1639),g=a(7065),m=a(5683),w=a(3246),k=a(490),f=a(1233),y=a(2146),v=a(9984),C=a.n(v);const _=(0,h.Z)(d,[["render",c]]),b=_;C()(d,"components",{QBtn:g.Z,QMenu:m.Z,QList:w.Z,QItem:k.Z,QItemSection:f.Z}),C()(d,"directives",{ClosePopup:y.Z});var U=a(3297);const A=(0,s.aZ)({name:"MainLayout",components:{headerBtnMenu:b},mounted(){(0,p.m)().getUseNameAsSession(),console.log("start")},computed:Object.assign(Object.assign({},(0,r.Ah)(U.c,["apiKey","validApiKey"])),(0,r.Ah)(p.m,["vipExpirationDate"])),methods:Object.assign(Object.assign({},(0,r.nv)(U.c,["validateApiKey","handleAboutUsClick","handleLogoutClick","handleMessageClick","handleUpgradeVipClick","handleUserClick","saveApiKey","checkVipExpire"])),{goToChatPage(){this.$router.push("/chat-page")},goToRegisterPage(){this.$router.push("/register-page")},goToBuyPage(){this.$router.push("/buy-page")},goToUserAdmin(){this.$router.push("/user-admin")}})});var W=a(7605),Z=a(6602),K=a(1663),D=a(4925),j=a(2857),q=a(7638),Q=a(2133);const x=(0,h.Z)(A,[["render",n],["__scopeId","data-v-bf389e14"]]),P=x;C()(A,"components",{QLayout:W.Z,QHeader:Z.Z,QToolbar:K.Z,QBtn:g.Z,QInput:D.Z,QMenu:m.Z,QList:w.Z,QItem:k.Z,QItemSection:f.Z,QIcon:j.Z,QDrawer:q.Z,QPageContainer:Q.Z}),C()(A,"directives",{ClosePopup:y.Z})}}]);