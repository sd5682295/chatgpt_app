"use strict";(globalThis["webpackChunkgtphtml"]=globalThis["webpackChunkgtphtml"]||[]).push([[990],{6510:(t,e,o)=>{o.d(e,{j:()=>n});var s=o(1809),i=o(7524),a=o(438);const n=(0,s.Q_)("useAdminData",{state:()=>({userInfoList:[]}),actions:{removeTimeFromDate(t){const e=t.replace(/\s\d{1,2}:\d{1,2}:\d{1,2}/,"");return e},getUserInfo(){const t=localStorage.getItem("session");console.log(["getUserInfo",t]),t?i.Z.post("http://120.48.84.244:5000/getUserList/",JSON.stringify({session:t}),{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((t=>{const e=t.data;0!==e.resCode?console.log(e.msg):this.userInfoList=e.userInfoList})).catch((t=>{console.error(t)})):console.log("Session not found")},formatDate(t){if("string"===typeof t)return t;if(t instanceof Date&&!isNaN(t.getTime())){const e=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${o}-${s}`}return"-"},editRow(t){(0,a.a)().userName=this.userInfoList[t].username,console.log(["editRow",typeof this.userInfoList[t].vipExpirationDate,this.userInfoList[t].vipExpirationDate]),(0,a.a)().vipExpirationDate=this.removeTimeFromDate(this.userInfoList[t].vipExpirationDate),(0,a.a)().tag="edit",this.router.push("/user-info-edit")},deleteRow(t){const e=this.userInfoList[t],{id:o}=e,s=localStorage.getItem("session"),a=JSON.stringify({id:o,session:s});this.userInfoList.splice(t,1),i.Z.post("http://120.48.84.244:5000/uerDelete/",a,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((t=>{console.log(t)})).catch((t=>{console.error("There was a problem with the axios operation:",t)}))},onAddItem(){(0,a.a)().tag="create",this.router.push("/user-info-edit")}}})},438:(t,e,o)=>{o.d(e,{a:()=>r});var s=o(1809),i=o(7813),a=o(7524),n=o(6510);const r=(0,s.Q_)("userInfoEditer",{state:()=>({password:"",userName:"",vipExpirationDate:null,tag:"edit",path:""}),actions:{editUserInfo(){console.log(["editUserIndfo",typeof this.vipExpirationDate,this.vipExpirationDate]);const t=localStorage.getItem("session"),e=JSON.stringify({username:this.userName,password:i.V8.hashStr(this.password),vipExpirationDate:this.vipExpirationDate,session:t});"edit"===this.tag?this.path="http://120.48.84.244:5000/editUserInfo/":this.path="http://120.48.84.244:5000/createUserInfo/",a.Z.post(this.path,e,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((t=>{0!==t.resCode?(alert("出错了，重新登入管理员账号请重试一次"),console.log("todo")):(localStorage.setItem("session",t.session),this.vipExpirationDate=t.vipExpirationDate,console.log("注册或者创建成功"))})).catch((t=>{console.error(t)}))},clearData(){this.userName="",this.password="",this.vipExpirationDate=(0,n.j)().formatDate(new Date)},stringToDate(t){return new Date(t)}}})},8990:(t,e,o)=>{o.r(e),o.d(e,{default:()=>h});var s=o(9835),i=o(1957);const a=(0,s._)("h3",{style:{"margin-left":"0.9375rem","margin-top":"1.25rem","margin-bottom":"1.25rem"}}," user admin ",-1);function n(t,e,o,n,r,l){const p=(0,s.up)("el-table-column"),d=(0,s.up)("el-button"),c=(0,s.up)("el-table");return(0,s.wg)(),(0,s.iD)("div",null,[a,(0,s.Wm)(c,{data:t.userInfoList,"max-height":"500","virtual-scroll":""},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{prop:"id",label:"ID",width:"80"}),(0,s.Wm)(p,{prop:"username",label:"Username",width:"120"}),(0,s.Wm)(p,{prop:"vipExpirationDate",label:"VIP Expiration Date",width:"150",formatter:t.formatDate},null,8,["formatter"]),(0,s.Wm)(p,{fixed:"right",label:"Operations",width:"120"},{default:(0,s.w5)((e=>[(0,s.Wm)(d,{link:"",type:"primary",size:"small",onClick:(0,i.iM)((o=>t.editRow(e.$index)),["prevent"])},{default:(0,s.w5)((()=>[(0,s.Uk)(" edit ")])),_:2},1032,["onClick"]),(0,s.Wm)(d,{link:"",type:"primary",size:"small",onClick:(0,i.iM)((o=>t.deleteRow(e.$index)),["prevent"])},{default:(0,s.w5)((()=>[(0,s.Uk)(" Remove ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,s.Wm)(d,{class:"mt-4",onClick:t.onAddItem},{default:(0,s.w5)((()=>[(0,s.Uk)("Add Item")])),_:1},8,["onClick"])])}var r=o(1809),l=o(6510);const p=(0,s.aZ)({name:"userAdmin",setup(){return{}},mounted(){(0,l.j)().getUserInfo()},computed:Object.assign({},(0,r.Ah)(l.j,["userInfoList"])),methods:Object.assign({},(0,r.nv)(l.j,["deleteRow","editRow","getUserInfo"]))});var d=o(1639);const c=(0,d.Z)(p,[["render",n]]),h=c}}]);