"use strict";(globalThis["webpackChunkgtphtml"]=globalThis["webpackChunkgtphtml"]||[]).push([[392],{6510:(e,t,s)=>{s.d(t,{j:()=>n});var o=s(1809),a=s(7524),i=s(438);const n=(0,o.Q_)("useAdminData",{state:()=>({userInfoList:[]}),actions:{removeTimeFromDate(e){const t=e.replace(/\s\d{1,2}:\d{1,2}:\d{1,2}/,"");return t},getUserInfo(){const e=localStorage.getItem("session");console.log(["getUserInfo",e]),e?a.Z.post("http://120.48.84.244:5000/getUserList/",JSON.stringify({session:e}),{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((e=>{const t=e.data;0!==t.resCode?console.log(t.msg):this.userInfoList=t.userInfoList})).catch((e=>{console.error(e)})):console.log("Session not found")},formatDate(e){if("string"===typeof e)return e;if(e instanceof Date&&!isNaN(e.getTime())){const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${o}`}return"-"},editRow(e){(0,i.a)().userName=this.userInfoList[e].username,console.log(["editRow",typeof this.userInfoList[e].vipExpirationDate,this.userInfoList[e].vipExpirationDate]),(0,i.a)().vipExpirationDate=this.removeTimeFromDate(this.userInfoList[e].vipExpirationDate),(0,i.a)().tag="edit",this.router.push("/user-info-edit")},deleteRow(e){const t=this.userInfoList[e],{id:s}=t,o=localStorage.getItem("session"),i=JSON.stringify({id:s,session:o});this.userInfoList.splice(e,1),a.Z.post("http://120.48.84.244:5000/uerDelete/",i,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((e=>{console.log(e)})).catch((e=>{console.error("There was a problem with the axios operation:",e)}))},onAddItem(){(0,i.a)().tag="create",this.router.push("/user-info-edit")}}})},438:(e,t,s)=>{s.d(t,{a:()=>r});var o=s(1809),a=s(7813),i=s(7524),n=s(6510);const r=(0,o.Q_)("userInfoEditer",{state:()=>({password:"",userName:"",vipExpirationDate:null,tag:"edit",path:""}),actions:{editUserInfo(){console.log(["editUserIndfo",typeof this.vipExpirationDate,this.vipExpirationDate]);const e=localStorage.getItem("session"),t=JSON.stringify({username:this.userName,password:a.V8.hashStr(this.password),vipExpirationDate:this.vipExpirationDate,session:e});"edit"===this.tag?this.path="http://120.48.84.244:5000/editUserInfo/":this.path="http://120.48.84.244:5000/createUserInfo/",i.Z.post(this.path,t,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}).then((e=>{0!==e.resCode?(alert("出错了，重新登入管理员账号请重试一次"),console.log("todo")):(localStorage.setItem("session",e.session),this.vipExpirationDate=e.vipExpirationDate,console.log("注册或者创建成功"))})).catch((e=>{console.error(e)}))},clearData(){this.userName="",this.password="",this.vipExpirationDate=(0,n.j)().formatDate(new Date)},stringToDate(e){return new Date(e)}}})},2392:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var o=s(9835);const a={class:"q-gutter-md q-mt-xl q-mb-xl q-pa-md q-ma-sm",style:{"max-width":"600px"}},i=(0,o._)("h3",{style:{"font-size":"24px",color:"#333","border-bottom":"1px solid #ddd"}}," 修改用户信息 ",-1),n={class:"q-mb-md"},r={class:"q-mb-lg"},l={class:"q-mb-md"};function p(e,t,s,p,d,u){const m=(0,o.up)("q-input"),c=(0,o.up)("q-btn"),h=(0,o.up)("q-form");return(0,o.wg)(),(0,o.iD)("div",a,[i,(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o.Wm)(m,{modelValue:e.userName,"onUpdate:modelValue":t[0]||(t[0]=t=>e.userName=t),label:"用户名",type:"text",outlined:"",dense:"",maxlength:20},null,8,["modelValue"])]),(0,o._)("div",r,[(0,o.Wm)(m,{modelValue:e.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),label:"新密码，不修改密码不需要填写",type:"password",outlined:"",dense:"","show-password":!0},null,8,["modelValue"])]),(0,o._)("div",l,[(0,o.Wm)(m,{modelValue:e.vipExpirationDate,"onUpdate:modelValue":t[2]||(t[2]=t=>e.vipExpirationDate=t),format:e.stringToDate,label:"VIP到期日期",type:"date",outlined:"",dense:""},null,8,["modelValue","format"])]),(0,o.Wm)(c,{type:"submit",label:"提交信息",color:"primary",class:"q-mt-md",onClick:e.editUserInfo},null,8,["onClick"])])),_:1})])}var d=s(1809),u=s(438);const m=(0,o.aZ)({name:"registerPage",setup(){return{}},computed:Object.assign({},(0,d.Ah)(u.a,["password","userName","vipExpirationDate"])),methods:Object.assign({},(0,d.nv)(u.a,["editUserInfo","stringToDate"]))});var c=s(1639),h=s(8326),g=s(4925),f=s(7065),D=s(9984),v=s.n(D);const w=(0,c.Z)(m,[["render",p]]),I=w;v()(m,"components",{QForm:h.Z,QInput:g.Z,QBtn:f.Z})}}]);